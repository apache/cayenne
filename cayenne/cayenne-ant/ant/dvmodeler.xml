<?xml version="1.0"?>

<!-- ========================================== -->
<!-- Cayenne Data View Modeler subproject buildfile.-->
<!-- ========================================== -->
<project>
	
	<property name="dvmodeler.dist.src" value="${dist}/src/dvmodeler"/>
	<property name="dvmodeler.build" value="${build}/dvmodeler/classes"/>
	<property name="dvmodeler.src" value="${cayenne.java}/src/dvmodeler/java"/>
	<property name="dvmodeler.bin" value="${cayenne.java}/src/dvmodeler/bin"/>
	
	<!-- ========================================== -->
	<!-- Build targets.                             -->
	<!-- ========================================== -->
	
	<target name="compile">
		<compile-1_4 destdir="${dvmodeler.build}" srcref="srcpath-dvmodeler"
			classpathref="classpath-cayenne-lib"/>
		
		<!-- copy resources -->
		<copy-properties destdir="${dvmodeler.build}" srcdir="${dvmodeler.src}"/>
		<copy todir="${dvmodeler.build}">
			<fileset dir="${dvmodeler.src}">
				<include name="**/*.xml"/>
				<include name="**/*.gif"/>
				<include name="**/*.jpg"/>
			</fileset>
		</copy>
	</target>
	
	<target name="dist-src" depends="dist-bin">
		<copy todir="${dvmodeler.dist.src}">
			<fileset dir="${dvmodeler.src}"/>
		</copy>
	</target>
	
	<target name="dist-bin" depends="jar">
		<copy-scripts srcdir="${dvmodeler.bin}"/>
		
		<copy todir="${dist}/lib/dvmodeler">
			<fileset dir="${cayenne.java}/lib">
				<include name="${jdom.jar}"/>
				<include name="${jgoodies.forms.jar}"/>
				<include name="${jgoodies.forms-extras.jar}"/>
				<include name="${jgoodies.looks.jar}"/>
			</fileset>
		</copy>
	</target>
	
	<!-- ========================================== -->
	<!-- Build Modeler JAR file.                    -->
	<!-- ========================================== -->
	<target name="jar" depends="compile">
		<mkdir dir="${dist}/lib/dvmodeler"/>
		
		<jar jarfile="${dist}/lib/dvmodeler/cayenne-dvmodeler.jar">
			<fileset dir="${dvmodeler.build}"/>
			
			<metainf dir="${license.dir}" includes="LICENSE.txt"/>
			<manifest>
				<attribute name="Built-By" value="${user.name}"/>
				<attribute name="Extension-Name" value="org.objectstyle.cayenne"/>
				<attribute name="Specification-Version" value="${project.name}"/>
				<attribute name="Specification-Vendor" value="ObjectStyle.org"/>
				<attribute name="Implementation-Vendor-Id"
					value="org.objectstyle"/>
				<attribute name="Implementation-Version"
					value="${project.version}"/>
				<attribute name="Implementation-Vendor" value="ObjectStyle.org"/>
				<attribute name="Main-Class"
					value="org.objectstyle.cayenne.dataview.dvmodeler.Main"/>
				<attribute name="Class-Path"
					value="${jdom.jar} ${jgoodies.forms.jar} ${scope.jar} ${jgoodies.looks.jar}"/>
			</manifest>
		</jar>
	</target>
</project>
