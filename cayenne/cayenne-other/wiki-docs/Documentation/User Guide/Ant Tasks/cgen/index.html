<!--
   Licensed to the Apache Software Foundation (ASF) under one
   or more contributor license agreements.  See the NOTICE file
   distributed with this work for additional information
   regarding copyright ownership.  The ASF licenses this file
   to you under the Apache License, Version 2.0 (the
   "License"); you may not use this file except in compliance
   with the License.  You may obtain a copy of the License at
 
     http://www.apache.org/licenses/LICENSE-2.0
 
   Unless required by applicable law or agreed to in writing,
   software distributed under the License is distributed on an
   "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
   KIND, either express or implied.  See the License for the
   specific language governing permissions and limitations
   under the License.
-->
<html>
  <head>
    <title>Apache Cayenne Documentation - cgen</title>
    <style type="text/css">@import "../../../../style.css";</style>
  </head>
<body>
  <div class="header">
    <div style="float: left;"><a href="http://incubator.apache.org/cayenne/"><img src="../../../../images/logo.gif" align="absmiddle" border="0"></a></div>
    <span class="logoSpaceLink"><a href="../../../../index.html">Cayenne User Documentation</a></span><br />
    <span class="pagetitle">cgen</span>
  </div>
<div id="cayenne_toc">
<ul>
<li><a href="../../../../Documentation/User Guide/Introduction/index.html">Introduction</a></li>
<li><a href="../../../../Documentation/User Guide/Installation/index.html">Installation</a></li>
<li><a href="../../../../Documentation/User Guide/Quick Start/index.html">Quick Start</a></li>
<li><a href="../../../../Documentation/User Guide/Design/index.html">Design</a></li>
<li><a href="../../../../Documentation/User Guide/DataContext/index.html">DataContext</a></li>
<li><a href="../../../../Documentation/User Guide/Queries/index.html">Queries</a></li>
<li><a href="../../../../Documentation/User Guide/DataObjects/index.html">DataObjects</a></li>
<li><a href="../../../../Documentation/User Guide/Stored Procedures/index.html">Stored Procedures</a></li>
<li><a href="../../../../Documentation/User Guide/Expressions/index.html">Expressions</a></li>
<li><a href="../../../../Documentation/User Guide/Performance Tuning/index.html">Performance Tuning</a></li>
<li><a href="../../../../Documentation/User Guide/Deployment/index.html">Deployment</a></li>
<li><a href="../../../../Documentation/User Guide/Ant Tasks/index.html">Ant Tasks</a><ul>
<li><a href="../../../../Documentation/User Guide/Ant Tasks/cgen/index.html">cgen</a><ul>
</ul>
</li>
<li><a href="../../../../Documentation/User Guide/Ant Tasks/cdbgen/index.html">cdbgen</a></li>
<li><a href="../../../../Documentation/User Guide/Ant Tasks/cdeploy/index.html">cdeploy</a></li>
<li><a href="../../../../Documentation/User Guide/Ant Tasks/cdataport/index.html">cdataport</a></li>
</ul>
</li>
<li><a href="../../../../Documentation/User Guide/Customizing/index.html">Customizing</a></li>
<li><a href="../../../../Documentation/User Guide/DataViews/index.html">DataViews</a></li>
</ul>
</div>
<div id="ConfluenceContent">
<p><tt>cgen</tt> is an Ant task that generates and maintains DataObjects source files based on Cayenne DataMap. If "makepairs" is set to "true" (default), this task will generate a pair of classes (superclass/subclass) for each ObjEntity in the DataMap. Superclasses should not be changed manually, since they are always overwritten. Subclasses are never overwritten and may be later customized by the user. If "makepairs" is set to "false", a single class will be generated for each ObjEntity.</p>

<p>By creating custom templates, Cgen can also be used to generate other output (such as web pages, reports, specialized code templates) based on DataMap information.</p>

<h3><a name="cgen-Parameters"></a>Parameters</h3>
<table class='confluenceTable'><tbody>
<tr>
<th class='confluenceTh'>Attribute</th>
<th class='confluenceTh'>Description</th>
<th class='confluenceTh'>Required</th>
</tr>
<tr>
<td class='confluenceTd'>map</td>
<td class='confluenceTd'>DataMap XML file to use as a base for class generation.</td>
<td class='confluenceTd'>Yes</td>
</tr>
<tr>
<td class='confluenceTd'>additionalMaps</td>
<td class='confluenceTd'>Path to additional DataMap XML files to use for class generation.</td>
<td class='confluenceTd'>No</td>
</tr>
<tr>
<td class='confluenceTd'>destDir</td>
<td class='confluenceTd'>Destination directory for Java classes (ignoring their package names).</td>
<td class='confluenceTd'>Yes</td>
</tr>
<tr>
<td class='confluenceTd'>overwrite</td>
<td class='confluenceTd'>If set to "true", will overwrite older versions of generated classes. Ignored unless makepairs is set to "false".</td>
<td class='confluenceTd'>No</td>
</tr>
<tr>
<td class='confluenceTd'>makepairs</td>
<td class='confluenceTd'>If set to "true", will generate subclass/superclass pairs, with all generated code included in superclass (default is "true").</td>
<td class='confluenceTd'>No</td>
</tr>
<tr>
<td class='confluenceTd'>template</td>
<td class='confluenceTd'>Location of Velocity template file for Java class generation. If omitted, default template is used.</td>
<td class='confluenceTd'>No</td>
</tr>
<tr>
<td class='confluenceTd'>supertemplate</td>
<td class='confluenceTd'>Location of Velocity template file for Java superclass generation. Ignored unless "makepairs" set to "true". If omitted, default template is used.</td>
<td class='confluenceTd'>No</td>
</tr>
<tr>
<td class='confluenceTd'>superpkg</td>
<td class='confluenceTd'>Java package name of generated superclasses. Ignored unless "makepairs" set to "true". If omitted, each superclass will be assigned the same package as subclass. Note that having superclass in a different package would only make sense when "usepkgpath" is set to "true". Otherwise classes from different packages will end up in the same directory.</td>
<td class='confluenceTd'>No</td>
</tr>
<tr>
<td class='confluenceTd'>usepkgpath</td>
<td class='confluenceTd'>If set to "true" (default), a directory tree will be generated in "destDir" corresponding to the class package structure, if set to "false", classes will be generated in "destDir" ignoring their package.</td>
<td class='confluenceTd'>No</td>
</tr>
<tr>
<td class='confluenceTd'>encoding</td>
<td class='confluenceTd'>Specify generated file encoding if different from the default on current platform. Target encoding must be supported by the JVM running Ant build. Standard encodings supported by Java on all platforms are US-ASCII, ISO-8859-1, UTF-8, UTF-16BE, UTF-16LE, UTF-16. See Sun Java Docs for java.nio.charset.Charset for more information.</td>
<td class='confluenceTd'>No</td>
</tr>
<tr>
<td class='confluenceTd'>version</td>
<td class='confluenceTd'>Specifies template location and generator behavior. "1.1" is the old behavior, with templates located in "dotemplates" and "classgen" as the only velocity context attribute. "1.2" is the new behavior, with templates located in "dotemplates/v1.2" and "objEntity", "entityUtils", "stringUtils", and "importUtils" in the velocity context. (Default is "1.1")</td>
<td class='confluenceTd'>No</td>
</tr>
<tr>
<td class='confluenceTd'>excludeEntities</td>
<td class='confluenceTd'>Entities (expressed as a perl5 regex) to exclude from template generation. (Default is to include all entities in the DataMap)</td>
<td class='confluenceTd'>No</td>
</tr>
<tr>
<td class='confluenceTd'>includeEntities</td>
<td class='confluenceTd'>Entities (expressed as a perl5 regex) to include in template generation. (Default is to include all entities in the DataMap)</td>
<td class='confluenceTd'>No</td>
</tr>
<tr>
<td class='confluenceTd'>outputPattern</td>
<td class='confluenceTd'>Name of file for generated output. (Default is "*.java")</td>
<td class='confluenceTd'>No</td>
</tr>
<tr>
<td class='confluenceTd'>mode</td>
<td class='confluenceTd'>Specifies generator iteration target. "entity" performs one iteration for each selected entity. "datamap" performs one iteration per datamap (This is always one iteration since cgen currently supports specifying one-and-only-one datamap). (Default is "entity")</td>
<td class='confluenceTd'>No</td>
</tr>
<tr>
<td class='confluenceTd'>client</td>
<td class='confluenceTd'>Whether we are generating classes for the client tier in a <a href="../../../../Documentation/Remote Object Persistence Guide/index.html" title="Remote Object Persistence Guide">Remote Object Persistence</a> application. Default is "false"</td>
<td class='confluenceTd'>No</td>
</tr>
</tbody></table>

<h3><a name="cgen-Parametersspecifiedasnestedelements"></a>Parameters specified as nested elements</h3>
<table class='confluenceTable'><tbody>
<tr>
<th class='confluenceTh'>Attribute</th>
<th class='confluenceTh'>Description</th>
<th class='confluenceTh'>Required</th>
</tr>
<tr>
<td class='confluenceTd'>config</td>
<td class='confluenceTd'>CGen with version="1.2" also supports <span class="nobr"><a href="http://vpp.sourceforge.net/" title="Visit page outside Confluence" rel="nofollow">VPP<sup><img class="rendericon" src="../../../../images/linkext7.gif" height="7" width="7" align="absmiddle" alt="" border="0"/></sup></a></span> config nested elements for configuring the velocity template engine and adding objects to the velocity template. You can also reference a vppconfig element declared outside of the CGen task, but you'll need to insure that both <tt>vppconfig</tt> and <tt>cgen</tt> have been loaded with the same classloader by using the same ant taskdef loaderRef value for both tasks. See the <span class="nobr"><a href="http://vpp.sourceforge.net/manual/vppconfig.html" title="Visit page outside Confluence" rel="nofollow">VPP VPPConfig Manual<sup><img class="rendericon" src="../../../../images/linkext7.gif" height="7" width="7" align="absmiddle" alt="" border="0"/></sup></a></span> page for complete information.</td>
<td class='confluenceTd'>No</td>
</tr>
</tbody></table>

<h3><a name="cgen-Examples"></a>Examples</h3>

<p>Load the Ant task <em>(note: if you already loaded all Cayenne tasks via an antlib taskdef <a href="../../../../Documentation/User Guide/Ant Tasks/index.html" title="Ant Tasks">described before</a>, this step is not needed)</em>: </p>

<div class="code"><div class="codeContent">
<pre class="code-xml"><span class="code-tag">&lt;taskdef name=<span class="code-quote">"cgen"</span> classname=<span class="code-quote">"org.apache.cayenne.tools.CayenneGenerator"</span>&gt;</span>
    <span class="code-tag">&lt;classpath refid=<span class="code-quote">"classpath"</span>/&gt;</span>
<span class="code-tag">&lt;/taskdef&gt;</span></pre>
</div></div>

<p>Here is an example of using CGen to generate DataObject subclass/superclass pairs from DataMap located in "src/datamap.xml". All generated subclasses and superclasses will be saved in the same directory "src/java/dobj" regardless of their package names:</p>
<div class="code"><div class="codeContent">
<pre class="code-xml"><span class="code-tag">&lt;cgen map=<span class="code-quote">"src/datamap.xml"</span> destDir=<span class="code-quote">"src/java/dobj"</span> usepkgpath=<span class="code-quote">"false"</span>/&gt;</span></pre>
</div></div>
<p>Here is an example of using CGen to generate html pages for all entities starting with "Artist" in the DataMap:</p>
<div class="code"><div class="codeContent">
<pre class="code-xml">&lt;cgen map=<span class="code-quote">"src/datamap.xml"</span> destDir=<span class="code-quote">"src/doc/web"</span> makepairs=<span class="code-quote">"false"</span> usepkgpath=<span class="code-quote">"false"</span>
    template=<span class="code-quote">"EntityReport.vm"</span> includeEntities=<span class="code-quote">"Artist*"</span> outputPattern=<span class="code-quote">"*Report.html"</span>/&gt;</pre>
</div></div>

<p>Here is an example of using CGen with a nested config element:</p>

<div class="code"><div class="codeContent">
<pre class="code-xml">&lt;cgen map=<span class="code-quote">"src/datamap.xml"</span>
    destDir=<span class="code-quote">"src/doc/web"</span>
    makepairs=<span class="code-quote">"false"</span>
    usepkgpath=<span class="code-quote">"false"</span>
    template=<span class="code-quote">"EntityReport.vm"</span>
    includeEntities=<span class="code-quote">"Artist*"</span>
    outputPattern=<span class="code-quote">"*Report.html"</span>&gt;
    <span class="code-tag">&lt;config&gt;</span>
        <span class="code-tag">&lt;context&gt;</span>
            <span class="code-tag">&lt;property key=<span class="code-quote">"myPropertyName"</span> value=<span class="code-quote">"myPropertyValue"</span> /&gt;</span>
            <span class="code-tag">&lt;tool key=<span class="code-quote">"myToolName"</span> className=<span class="code-quote">"org.myDomain.MyTool"</span> /&gt;</span>
        <span class="code-tag">&lt;/context&gt;</span>
    <span class="code-tag">&lt;/config&gt;</span>
<span class="code-tag">&lt;/cgen&gt;</span></pre>
</div></div>

<p>Here is an example of using CGen with vppconfig:</p>

<div class="code"><div class="codeContent">
<pre class="code-xml">&lt;typedef name=<span class="code-quote">"vppconfig"</span>
    classname=<span class="code-quote">"foundrylogic.vpp.VPPConfig"</span>
    loaderref=<span class="code-quote">"aclasspathloader"</span>&gt;
    <span class="code-tag">&lt;classpath refid=<span class="code-quote">"aclasspath"</span>/&gt;</span>
<span class="code-tag">&lt;/typedef&gt;</span>

<span class="code-tag">&lt;vppconfig id=<span class="code-quote">"myconfig"</span>&gt;</span>
    <span class="code-tag">&lt;context&gt;</span>
        <span class="code-tag">&lt;property key=<span class="code-quote">"myPropertyName"</span> value=<span class="code-quote">"myPropertyValue"</span> /&gt;</span>
        <span class="code-tag">&lt;tool key=<span class="code-quote">"myToolName"</span> className=<span class="code-quote">"org.myDomain.MyTool"</span> /&gt;</span>
    <span class="code-tag">&lt;/context&gt;</span>
<span class="code-tag">&lt;/vppconfig&gt;</span>

&lt;cgen map=<span class="code-quote">"src/datamap.xml"</span>
    destDir=<span class="code-quote">"src/doc/web"</span>
    makepairs=<span class="code-quote">"false"</span>
    usepkgpath=<span class="code-quote">"false"</span>
    template=<span class="code-quote">"EntityReport.vm"</span>
    includeEntities=<span class="code-quote">"Artist*"</span>
    outputPattern=<span class="code-quote">"*Report.html"</span>&gt;
    <span class="code-tag">&lt;config refid=<span class="code-quote">"myconfig"</span> /&gt;</span>
<span class="code-tag">&lt;/cgen&gt;</span></pre>
</div></div></div>
</div>
  <div class="clearer">.</div>
  <div style="height: 12px; background-image: url('../../../../images/border_bottom.gif'); background-repeat: repeat-x;"></div>

  <div class="smalltext copyright">
    Copyright &copy;2001-2006 Apache Software Foundation
  </div>

</body>
</html>
